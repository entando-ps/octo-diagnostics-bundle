(this["webpackJsonpcard-diagnostics-widget"]=this["webpackJsonpcard-diagnostics-widget"]||[]).push([[0],{118:function(e){e.exports=JSON.parse("{}")},131:function(e,t,a){e.exports=a(174)},133:function(e,t,a){},174:function(e,t,a){"use strict";a.r(t);var n,i=a(106),r=a(107),o=a(108),c=a(122),l=a(123),s=a(13),u=a(0),d=a.n(u),m=(a(133),a(9)),g=a(214),f={serviceUrl:null,appName:null,logoUrl:null,themeColor:null,themeSecondaryColor:null,languageCode:null,language:null},v=Object(g.a)((function(){return Object(u.useState)(f)})),p=v.Provider,h=v.useTracked,b=a(42),E=a.n(b),y=(a(213),a(210),a(217),a(215),a(208)),w={default:{fontSize:"18pt",fontWeight:"bold",marginBottom:"1rem",color:"#46515f"}},D=function(e){return"N/A"===e?e:function(e){return d.a.createElement("span",{className:"overflow-wrap",style:{color:f.themeColor}},e)}(e)},O=function(e){return n||(n=E()({root:{"&.MuiAccordionDetails-root":{display:"block",backgroundColor:f.themeColor+"20"}}})(y.a)),d.a.createElement(n,e)},k=Object(u.createContext)([{},function(){}]),S=function(){var e=Object(u.useContext)(k),t=Object(m.a)(e,2),a=t[0],n=t[1];return{platform:a.platform,userInfo:a.userInfo,setUserInfo:function(e,t){var a=JSON.parse(t);n((function(t){return Object(s.a)(Object(s.a)({},t),{},{platform:e,userInfo:a})}))}}},N=a(79),C=a.n(N),j=function(e){var t=e.children,a=e.onLoading,n=h(),i=Object(m.a)(n,1)[0];return d.a.createElement("div",{className:"card",style:{boxShadow:"0 0 8px 0 "+i.themeColor+"80"}},d.a.createElement("div",{className:"card-title"},t[0]),a?d.a.createElement("div",{style:{textAlign:"center"}},d.a.createElement(C.a,{style:{color:i.themeColor}})):d.a.createElement("div",{className:"mt-2 font12"},t[1]))},A=(a(109),function(){var e=h(),t=Object(m.a)(e,1)[0];return d.a.createElement("div",{className:"header-frame"},d.a.createElement("div",{style:w.default},"it"===t.languageCode?d.a.createElement(d.a.Fragment,null,D("Diagnostica")):d.a.createElement(d.a.Fragment,null,D("Diagnostics"))))}),T=Object(u.createContext)([{},function(){}]),I=function(){var e=Object(u.useContext)(T),t=Object(m.a)(e,2),a=t[0],n=t[1];return{devicesDiagnosticsData:a.devicesDiagnosticsData,apiDiagnosticsData:a.apiDiagnosticsData,setApiDiagnosticsData:function(e){n((function(t){return Object(s.a)(Object(s.a)({},t),{},{apiDiagnosticsData:e})}))}}},F=a(216),x=a(212),z=a(211),L=a(91),P=a.n(L),B=a(114),M=a.n(B),R=function(){var e=h(),t=Object(m.a)(e,1)[0].language,a=I().devicesDiagnosticsData;return a.length>0&&0!==a[0].type?d.a.createElement(d.a.Fragment,null,a.map((function(e,a){var n=void 0!==t.diagnostics.btDevices[e.type]?t.diagnostics.btDevices[e.type]:t.diagnostics.btDevices[0];return d.a.createElement("div",{style:w.default,key:a},d.a.createElement(j,{children:[d.a.createElement(d.a.Fragment,null,D(n)),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",null,"Firmware: ",D(e.firmware)),d.a.createElement("div",null,t.diagnostics.metricNames.battery,": ",D(e.battery)),d.a.createElement("div",null,t.diagnostics.metricNames.serial,": ",D(e.serial)),d.a.createElement("div",null,"RSSI: ",D(e.rssi)))],onLoading:!1}))}))):d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"mt-2 font14"},t.diagnostics.noBTDevices))},W=a(90),U=a.n(W),V=a(113),H=a.n(V),K=a(83),G=a(64),J=a.n(G),Y=a(110),Q=a(111),q=a(112),X="speed",Z="engine rpm",$="fuel level absolute",_="odometer",ee="mil",te="ignition status",ae="stored dtc",ne="freeze dtc",ie="vin",re=function(){var e=h(),t=Object(m.a)(e,1)[0].language,a=I().apiDiagnosticsData;return a&&a.length>0?d.a.createElement(d.a.Fragment,null,a.map((function(e,a){var n=function(e,t){if(void 0===e||null===e)return d.a.createElement(d.a.Fragment,null);var a,n,i={float:"right"};switch(e=e.toLowerCase()){case X:a=d.a.createElement(U.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.speed;break;case Z:a=d.a.createElement(U.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.engineRpm;break;case $:a=d.a.createElement(H.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.fuelLevel;break;case _:a=d.a.createElement(K.Icon,{icon:Y.a,style:i,width:"1.8em",height:"1.8em"}),n=t.diagnostics.metricNames.odometer;break;case ee:a=d.a.createElement(K.Icon,{icon:Q.a,style:i,width:"1.8em",height:"1.8em"}),n=t.diagnostics.metricNames.mil;break;case te:a=d.a.createElement(K.Icon,{icon:q.a,style:i,width:"1.8em",height:"1.8em"}),n=t.diagnostics.metricNames.ignitionStatus;break;case ae:a=d.a.createElement(J.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.storedDtc;break;case ne:a=d.a.createElement(J.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.freezeDtc;break;case ie:a=d.a.createElement(J.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.vin;break;default:a=d.a.createElement(J.a,{style:i,fontSize:"large"}),n=t.diagnostics.metricNames.unknown}return{icon:a,label:n}}(e.name,t),i=e.value+" "+e.units;return te===e.name.toLowerCase()&&(i=1===Number.parseInt(e.value)?t.diagnostics.metricNames.ignitionStatusOn:t.diagnostics.metricNames.ignitionStatusOff),d.a.createElement("div",{style:w.default,key:a},d.a.createElement(j,{children:[d.a.createElement(d.a.Fragment,null,D(n.label),n.icon),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:{marginTop:"-1.4rem"}},i),d.a.createElement("div",{className:"date-info"},new Date(e.date).toUTCString()))],onLoading:!1}))}))):d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"mt-2 font14"},t.diagnostics.noApiMetrics))},oe=a(35),ce=a.n(oe),le=a(58),se=function(e){return{headers:new Headers({Authorization:"Basic ".concat(e),"Content-Type":"application/json",Cookie:(t="idOperator",document.cookie&&document.cookie.split("; ").find((function(e){return e.startsWith(t+"=")}))?document.cookie.split("; ").find((function(e){return e.startsWith(t+"=")})).split("=")[1]:null)})};var t},ue=function(){var e=Object(le.a)(ce.a.mark((function e(t,a,n){var i,r;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(s.a)(Object(s.a)({},se(a)),n),e.next=3,fetch(t,i);case 3:if((r=e.sent).status,204!==r.status){e.next=7;break}return e.abrupt("return",{});case 7:if(!(r.status>=200&&r.status<300)){e.next=9;break}return e.abrupt("return",r.json());case 9:return e.abrupt("return",Promise.reject(new Error(r.statusText||r.status)));case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),de=function(){var e=Object(le.a)(ce.a.mark((function e(t,a){var n,i;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t,"/diagnostics/").concat(a.voucherId),i={method:"GET"},e.abrupt("return",ue(n,a.basicAuth64,i));case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),me=a(115),ge=a.n(me),fe=a(116),ve=a.n(fe),pe=function(){var e=h(),t=Object(m.a)(e,1)[0],a=t.language,n=Object(u.useState)(!1),i=Object(m.a)(n,2),r=i[0],o=i[1],c=S().userInfo,l=I().setApiDiagnosticsData,g=M()((function(e){return{heading:{fontSize:e.typography.pxToRem(16),fontWeight:e.typography.fontWeightBold,color:"#46515f"},sectionTitle:{fontSize:e.typography.pxToRem(20),fontWeight:e.typography.fontWeightBold,color:"#46515f",marginBottom:"0.5rem"}}}))();return Object(u.useEffect)((function(){c&&"N/A"!==c.basicAuth64&&(o(!0),de(t.serviceUrl,c).then((function(e){l(e.payload.lastMetrics)})).catch((function(e){console.log("ERR GET DiagnosticsData: ",e)})).finally((function(){return o(!1)})))}),[c]),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{style:Object(s.a)(Object(s.a)({},w.default),{},{padding:"0.5rem"})},d.a.createElement(z.a,{className:g.sectionTitle},a.diagnostics.title),d.a.createElement(F.a,null,d.a.createElement(x.a,{expandIcon:d.a.createElement(P.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},d.a.createElement(ge.a,{className:"diagnostics-source-icon",fontSize:"large"}),d.a.createElement(z.a,{className:g.heading},"it"===t.languageCode?d.a.createElement(d.a.Fragment,null,"dei tuoi dispositivi ",D("bluetooth")):d.a.createElement(d.a.Fragment,null,"from your ",D("bluetooth")," devices"))),d.a.createElement(O,null,d.a.createElement(R,null))),d.a.createElement(F.a,{style:{marginTop:"1rem"}},d.a.createElement(x.a,{expandIcon:d.a.createElement(P.a,null),"aria-controls":"panel2a-content",id:"panel2a-header"},d.a.createElement(ve.a,{className:"diagnostics-source-icon",fontSize:"large"}),d.a.createElement(z.a,{className:g.heading},"it"===t.languageCode?d.a.createElement(d.a.Fragment,null,"del tuo ",D("veicolo")):d.a.createElement(d.a.Fragment,null,"from your ",D("vehicle")))),d.a.createElement(O,null,r?d.a.createElement("div",{style:{textAlign:"center"}},d.a.createElement(C.a,{style:{color:t.themeColor}})):d.a.createElement(re,null)))))},he=function(){return d.a.createElement("div",{className:"main-frame"},d.a.createElement("div",{className:"content-frame"},d.a.createElement(A,null),d.a.createElement(pe,null)))},be=a(12),Ee={language:"EN",button:{next:"Next",tryAgain:"Try again",verify:"Verify",accept:"Accept",refuse:"Refuse",gotIt:"Got it",okGotIt:"Ok, got it",letsStart:"Let's start"},error:{tryAgain:"An error has occurred, please try again.",emailAlreadyRegistered:"This email is already registered",wrongCodeTitle:"Wrong Phone Verification Code",wrongCodeMessage:"There was an error with your Verification Code. Please try again.",sorry:"We're sorry",somethingWrong:"Something has gone wrong, retry."},stepper:{step:"Step ",of:" of "},nameStep:{welcome:"Welcome to ",whatIsYourName:"What is your name?",firstname:"Name",lastname:"Last name",vehiclePlate:"Vehicle plate",vehicleBrand:"Vehicle brand",vehicleModel:"Vehicle model",vehicleColor:"Vehicle color"},diagnostics:{title:"Diagnostics data:",noBTDevices:"No BT devices",noApiMetrics:"No data available",btDevices:{14:"SM Tag",12:"PurePlace",11:"Smart Tag",9:"Smoke Detector",5:"Smart Key",4:"Transponder Tag (Nano)",1:"Box",0:"Unknown device"},metricNames:{battery:"Battery",serial:"Serial",speed:"Speed",engineRpm:"Engine RPM",fuelLevel:"Fuel level absolute",odometer:"Odometer",mil:"MIL",ignitionStatus:"Ignition status",ignitionStatusOn:"On",ignitionStatusOff:"Off",storedDtc:"Stored DTC",freezeDtc:"Freeze DTC",vin:"VIN",unknown:"Unknown metric"},details:"Details",speed:{your:"Your ",speedLimit:"speed limit "},poi:{last:"Last created ",poi:"Point Of Interest ",created:"created by ",creationDate:"Creation date",lat:"Latitude",lon:"Longitude",radius:"Radius"}}},ye={language:"IT",button:{next:"Avanti",tryAgain:"Riprova",verify:"Avanti",accept:"Accetta",refuse:"Ignora",gotIt:"Ho capito",okGotIt:"Ho capito",letsStart:"Iniziamo"},error:{tryAgain:"Si \xe8 verificato un errore, si prega di riprovare.",emailAlreadyRegistered:"Questo indirizzo \xe8 gi\xe0 registrato",wrongCodeTitle:"Codice di verifica telefono errato",wrongCodeMessage:"C'\xe8 stato un errore con il codice di verifica. Si prega di riprovare.",sorry:"Ci dispiace",somethingWrong:"Si \xe8 verificato un errore, si prega di riprovare."},stepper:{step:"Passo ",of:" di "},nameStep:{welcome:"Benvenuto su ",whatIsYourName:"Qual \xe8 il tuo nome?",firstname:"Nome",lastname:"Cognome",vehiclePlate:"Targa veicolo",vehicleBrand:"Marca veicolo",vehicleModel:"Modello veicolo",vehicleColor:"Colore veicolo"},diagnostics:{title:"I dati di diagnostica:",noBTDevices:"Non ci sono dispositivi BT",noApiMetrics:"Non ci sono dati disponibili",btDevices:{14:"SM Tag",12:"PurePlace",11:"Smart Tag",9:"Rilevatore di fumo",5:"Smart Key",4:"Transponder Tag (Nano)",1:"Box",0:"Dispositivo sconosciuto"},metricNames:{battery:"Batteria",serial:"Seriale",speed:"Velocit\xe0",engineRpm:"Giri del motore",fuelLevel:"Livello assoluto di carburante",odometer:"Contachilometri",mil:"MIL",ignitionStatus:"Stato del motore",ignitionStatusOn:"Acceso",ignitionStatusOff:"Spento",storedDtc:"Riserva DTC",freezeDtc:"DTC congelato",vin:"VIN",unknown:"Dato sconosciuto"},details:"Dettagli",speed:{your:"Il tuo ",speedLimit:"limite di velocit\xe0 "},poi:{last:"L'ultimo ",poi:"Point Of Interest ",created:"creato da ",creationDate:"Data di creazione",lat:"Latitudine",lon:"Longitudine",radius:"Raggio"}}};function we(e){var t;return window.location.href.indexOf(e)>-1&&(t=function(){var e={};return window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,n){e[a]=n})),e}()[e]),t}var De=function(e){var t=e.children,a=Object(u.useState)({devicesDiagnosticsData:[],apiDiagnosticsData:[]}),n=Object(m.a)(a,2),i=n[0],r=n[1],o=S().setUserInfo,c=function(e){var t=JSON.parse(e);r((function(e){return Object(s.a)(Object(s.a)({},e),{},{devicesDiagnosticsData:t})}))};return Object(u.useEffect)((function(){if(window.Android){console.log("Calling Android functions");var e=window.Android.userAuth();o("Android",e);var t=window.Android.diagnosticData();c(t)}else console.log("Setting in the window the functions to be called from iOS"),window.userAuth=function(e){o("iOS",e)},window.diagnosticData=function(e){c(e)}}),[]),d.a.createElement(T.Provider,{value:[i,r]}," ",t," ")},Oe=function(e){var t=e.children,a=Object(u.useState)({platform:"N/A",userInfo:{basicAuth64:"N/A",voucherId:"N/A"}}),n=Object(m.a)(a,2),i=n[0],r=n[1];return d.a.createElement(k.Provider,{value:[i,r]}," ",t," ")},ke=function(){return window&&window.entando&&window.entando.keycloak&&Object(s.a)(Object(s.a)({},window.entando.keycloak),{},{initialized:!0})||{initialized:!1}},Se={id:"id",disableDefaultEventHandler:"disable-default-event-handler",serviceUrl:"service-url"},Ne=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).keycloak=ke(),e}return Object(r.a)(a,[{key:"attributeChangedCallback",value:function(e,t,a){if(this.container&&t!==a){if(!Object.values(Se).includes(e))throw new Error("Untracked changed attribute: ".concat(e));e===Se.disableDefaultEventHandler&&this.onToggleDisableDefaultEvent(),this.render()}}},{key:"connectedCallback",value:function(){var e=this,t=this.getAttribute("app-name"),a=this.getAttribute("logo-url"),n=this.getAttribute("theme-color"),i=this.getAttribute("theme-secondary-color"),r=this.getAttribute("service-url");!function(e){f.appName=e}(t),function(e){f.logoUrl=e}(a),function(e){f.themeColor=e}(n),function(e){f.themeSecondaryColor=e}(i),function(e){f.serviceUrl=e}(r);var o,c,l=we("lang"),u=l&&"en"===l.toString().toLowerCase()?"en":"it",d="en"===u?Ee:ye;!function(e){f.languageCode=e}(u),function(e){f.language=e}(d),this.mountPoint=document.createElement("div"),this.appendChild(this.mountPoint),this.keycloak=Object(s.a)(Object(s.a)({},ke()),{},{initialized:!0}),this.unsubscribeFromKeycloakEvent=(o="keycloak",c=function(){e.keycloak=Object(s.a)(Object(s.a)({},ke()),{},{initialized:!0}),e.render()},window.addEventListener(o,c),function(){window.removeEventListener(o,c)}),this.onToggleDisableDefaultEvent(),this.render()}},{key:"disconnectedCallback",value:function(){this.unsubscribeFromWidgetEvents&&this.unsubscribeFromWidgetEvents(),this.unsubscribeFromKeycloakEvent&&this.unsubscribeFromKeycloakEvent()}},{key:"onToggleDisableDefaultEvent",value:function(){var e="true"===this.getAttribute(Se.disableDefaultEventHandler);e!==this.defaultEventHandlerDisabled&&(e&&(this.unsubscribeFromWidgetEvents&&this.unsubscribeFromWidgetEvents(),this.unsubscribeFromKeycloakEvent&&this.unsubscribeFromKeycloakEvent()),this.defaultEventHandlerDisabled=e)}},{key:"render",value:function(){be.render(d.a.createElement(p,null,d.a.createElement(Oe,null,d.a.createElement(De,null,d.a.createElement(he,null)))),this.mountPoint)}}],[{key:"observedAttributes",get:function(){return Object.values(Se)}}]),a}(Object(l.a)(HTMLElement));customElements.define("card-diagnostics",Ne);var Ce=a(92),je=a(117),Ae=a(118),Te=a(121),Ie={en:{translation:Ae}};Ce.a.use(je.a).use(Te.a).init({resources:Ie,lng:"en",keySeparator:!1,interpolation:{escapeValue:!1}});Ce.a}},[[131,1,2]]]);
//# sourceMappingURL=main.85cf32d3.chunk.js.map